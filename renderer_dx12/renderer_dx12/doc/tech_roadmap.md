# DirectX12 渲染架构技术路线图

## 路线图规划原则 （作为辅助编程的AI，你不应该修改这一部分）

这个项目的目标是完成一个灵活的，具有高可用性的渲染架构，可以方便得试验各种新渲染技术，一个工业级的游戏/渲染引擎不是这个项目的目标，进行渲染架构技术路线图时必须要考虑这一点，不要引入过高的复杂度、过多的抽象层等。

## 阶段 1：解耦与基础设施重构（近期）

- **移除单例与全局状态**：将 `DirectX12Device` 改为可显式构造、可并行存在的实例，确保线程安全，同时在单 GPU 场景下也能灵活配置设备。（✅ 已完成）
- **拆分初始化流程**：将设备创建、队列配置、交换链、描述符堆、离屏资源等步骤模块化，构建 RAII 式资源管理与失败回滚机制，并补充详细日志。（✅ 模块化完成，但日志/回滚仍需增强）
- **统一资源生命周期管理**：引入智能指针或自定义句柄封装，消除手动 `Release`，为后续自动化测试铺路。（✅ DXGI/D3D12 资源已统一管理）

## 阶段 2：帧资源与命令调度（中期）

- **构建帧资源环**：为每帧维护独立的命令分配器、命令列表、fence、常量缓冲等，支持并行录制与跨帧资源同步。（✅ 基础框架已具备命令分配器与 fence 管理，常量缓冲/示例仍待补充）
- **扩展命令队列池**：提供 direct / compute / copy 队列及其管理接口，允许实验异步 Pass、异步拷贝及任务调度策略。（⏳ 未开始）
- **完善同步机制**：抽象 fence 与事件管理，提供可配置的等待策略与调试可视化输出。（⏳ 未开始）

## 阶段 3：渲染目标与资源弹性（中期）

- **RenderTarget 管理器**：支持按需创建/销毁多尺寸、多格式的离屏纹理，提供 SRV/RTV 句柄分配。（✅ 基础支持完成，UAV/DSV 仍待扩展与示例）
- **动态重建能力**：实现窗口 Resize、MSAA、HDR 等配置的热更新流程，确保资源可安全回收与重建。（⏳ 未开始）
- **资源热替换**：支持 Shader、管线状态、根签名的快速重载，便于迭代新技术。（⏳ 未开始）

## 阶段 4：渲染流程编排（远期）

- **RenderGraph / Pass 描述**：设计基于依赖图的 Pass 管理，支持多阶段渲染实验与自动调度 Barrier。
- **材质与几何解耦**：重构 `ScreenQuad` 等基础组件，允许外部注入材质/常量缓冲布局，提升重用性。（✅ ScreenQuad 已支持材质注入、外部 CBV）
- **可扩展管线接口**：统一暴露 Pass 参数、资源绑定、调度策略，支持快速接入新渲染算法。（⏳ 待规划）

## 支撑措施

- **日志与调试工具**：构建统一日志系统，输出资源创建、同步、Barrier 等关键事件。（⏳ 基础日志初具雏形，需扩充）
- **自动化验证**：添加基本渲染快照或统计检查，确保架构调整后行为可预期。（⏳ 未开始）
- **文档维护**：同步更新 `arch_review.md` 与模块说明，记录设计决策、接口约定与实验指引。（✅ 正在迭代）
